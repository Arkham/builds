# Maintainer: Arkham <arkham at archlinux dot us>
# Contributor: Kaos <gianlucaatlas (at) gmail (dot) com>
# Contributor: Julius Bullinger <julius.bullinger@gmail.com>

pkgname=opera-devel-qt4
pkgver=10.10_4609
_build=4609
_realver=10.10-${_build}
pkgrel=1
pkgdesc="The Opera web browser development and testing version, shared Qt4 version"
arch=('i686' 'x86_64')
url="http://my.opera.com/desktopteam/blog"
license=('custom:opera')
depends=('qt')
conflicts=('opera' 'opera-devel' 'opera-static')
provides=('opera' 'opera-devel' 'opera-static')
source=(http://snapshot.opera.com/unix/snapshot-$_build/intel-linux/opera-$_realver.gcc4-qt4.i386.tar.bz2
        opera.desktop
        opera.svg)
[ "$CARCH" == "x86_64" ] && source[0]="http://snapshot.opera.com/unix/snapshot-$_build/x86_64-linux/opera-$_realver.gcc4-qt4.x86_64.tar.bz2"
md5sums=('fce6b9e568583f99a5e0130c4db45195'
         'e68398e5b8c4cb0b59fdb661ff1877e6'
         'bf26b6d02091786d4ed45f4874874e3a')
[ "$CARCH" == "x86_64" ] && md5sums[0]='a5c15547402284d449468ee011c4ea64'

build() {
    # Install the data and the license
    [ "$CARCH" == "i686" ] && cd $srcdir/opera-$_realver.gcc4-qt4.i386
    [ "$CARCH" == "x86_64" ] && cd $srcdir/opera-$_realver.gcc4-qt4.x86_64
    ./install.sh DESTDIR=$pkgdir || return 1
    install -Dm 644 LICENSE $pkgdir/usr/share/licenses/$pkgname/license.txt

    # Install .desktop and icon
    install -Dm 644 $srcdir/opera.desktop $pkgdir/usr/share/applications/opera.desktop
    install -Dm 644 $srcdir/opera.svg $pkgdir/usr/share/opera/images/opera.svg
}

# Calculate x86_64 md5
# eval $(grep "^_build" PKGBUILD) && eval $(grep "^_realver" PKGBUILD) && wget http://snapshot.opera.com/unix/snapshot-$_build/x86_64-linux/opera-$_realver.gcc4-qt4.x86_64.tar.bz2 && md5sum opera-$_realver.gcc4-qt4.x86_64.tar.bz2 && rm opera-$_realver.gcc4-qt4.x86_64.tar.bz2
