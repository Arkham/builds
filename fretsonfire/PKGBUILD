# Maintainer: Arkham <arkham at archlinux dot us>
# Contributor: Kristoffer Fossg√•rd <kfs1 at online dot no>

pkgname=fretsonfire
pkgver=1.3.110
pkgrel=3
pkgdesc="A game of musical skill and fast fingers. Play guitar with the keyboard as accurately as possible. Like guitar Hero."
url="http://fretsonfire.sourceforge.net/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('python-pygame' 'python-opengl' 'pil' 'python-numpy')
optdepends=('glew: Used for render-to-texture support' 
            'pyogg: Used for streaming OGG files from the disk')
[ "$CARCH" = "i686" ] && optdepends[3]='psyco: Used for speed optimization'
source=(http://downloads.sourceforge.net/$pkgname/FretsOnFire-$pkgver.tar.gz
        $pkgname.desktop
        $pkgname.sh
        $pkgname.png)
md5sums=('daa7e23ebc8ed5bc78aa5e9f4ca3471e'
         'e792e7dfe01775c0034781393c457696' 
         '39e141326c964ab2c6694334f17e77b7'
         '66668cad0211bf4e6ab1bd5efa8f65bf')

build() {
    # Installing the files
    cd $srcdir/Frets\ on\ Fire-$pkgver
    install -d $pkgdir/usr/share/$pkgname/{bin,data}
    cp -r src/* $pkgdir/usr/share/$pkgname/bin/
    cp -r data/* $pkgdir/usr/share/$pkgname/data/

    # Removing junk and setting permissions
    cd $pkgdir/usr/share/$pkgname/data
    rm -rf win32/ launcher* Makefile *.svg songs/tutorial/*.svg \
        mods/Chilly/*.svg mods/LightGraphics/*.svg 
    find $pkgdir/usr/share/$pkgname -type f -exec chmod 664 {} + 
    find $pkgdir/usr/share/$pkgname -type d -exec chmod 775 {} + 

    # Installing .desktop, icon and bin
    install -Dm 644 $srcdir/$pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
    install -Dm 644 $srcdir/$pkgname.png $pkgdir/usr/share/pixmaps/$pkgname.png
    install -Dm 755 $srcdir/$pkgname.sh $pkgdir/usr/bin/$pkgname
}
